#!/usr/bin/env bash
#SBATCH --error=mars_call_%j.err
#SBATCH --output=mars_call_%j.out
#SBATCH --job-name=mars_call

ml ecmwf-toolbox
ml eclib
yyyymm=201202
dd=01
area="60/5/-52.5/15" #around Denmark

com="class=ea,dataset=era5,stream=oper,type=fc,expver=1,levtype=sfc,param=228.12,area=$area"
com="class=ea,dataset=era5,stream=oper,type=fc,expver=1,levtype=sfc,date=$date,area=$area,param=$param"
ODIR=/ec/res4/scratch/nhd/verification/ERA5
#date=2012-01-01/to/2012-01-31,
param=1.228/3.228/7.228/8.128/8.228/9.128/9.228/10.228/11.228/12.228/13.228/14.228/15.128/15.228/16.128/16.228/17.128/17.228/18.128/18.228/19.228/20.235/21.228/21.235/22.228/23.228/23.235/24.228/24.235/26.128/26.235/27.235/29.228/29.235/30.235/31.128/31.235/32.128/32.235/33.128/33.235/34.128/34.235/35.128/35.235/36.128/36.235/37.128/37.235/38.128/38.235/39.128/39.235/40.128/40.235/41.128/41.235/42.128/42.235/43.235/44.128/45.128/45.235/46.235/47.235/48.235/49.128/49.235/50.128/50.235/51.235/52.235/53.162/53.235/54.162/54.235/55.235/56.235/57.128/57.235/58.235/59.128/59.162/59.235/60.162/61.162/62.162/63.162/64.162/65.162/66.128/66.162/67.128/67.162/68.162/68.235/69.162/69.235/70.162/70.235/71.162/72.162/73.162/74.162/75.162/76.162/77.162/78.128/78.162/79.128/79.162/80.162/81.162/82.162/83.162/84.162/85.162/86.162/87.162/88.162/88.228/89.162/89.228/90.162/90.228/91.162/129.128/129.228/130.228/131.228/132.228/134.128/136.128/137.128/139.128/141.128/142.128/143.128/144.128/145.128/146.128/147.128/148.128/151.128/159.128/164.128/165.128/166.128/167.128/168.128/169.128/170.128/172.128/175.128/176.128/177.128/178.128/179.128/180.128/181.128/182.128/183.128/186.128/187.128/188.128/195.128/196.128/197.128/198.128/201.128/202.128/205.128/206.128/208.128/209.128/210.128/211.128/212.128/213.128/217.228/218.228/219.228/220.228/221.228/226.228/227.228/228.128/229.128/230.128/231.128/232.128/235.128/236.128/238.128/239.128/240.128/243.128/244.128/245.128/246.228/247.228/251.228/260015/260121/260123
#param=167.128

#for dd in $(seq -w 29 31);do
for dd in 29;do
date=${yyyymm}$dd
OFILE=$ODIR/ERA5_${date}.grib
mars << eof
retrieve,
class=ea,
expver=1,
REPRES     = SH, 
GRID       = 0.1/0.1,
date=$date,
levtype=sfc,
param=$param,
step=0/1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18,
area=Europe,
stream=oper,
time=06:00:00/18:00:00,
type=fc,
target="$OFILE"
eof
done
